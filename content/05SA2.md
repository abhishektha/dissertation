# Specific Aim 2: Predictively model dynamic changes in foot morphology during gait {#sec:SA2}

## Introduction

Designing a new spacesuit boot to be more comfortable and not be subject to fit issues like heel-lift, requires a thorough understanding of foot shape. 
However, foot shape is known to be highly variable throughout the population, including by sex [@Wunderlich2001; @Krauss2008; @Krauss2010], age [@Tomassoni2014], and weight [@Price2016]. 
This variability is often not captured in terrestrial footwear sizing, as current fitting standards only use foot length, foot width, and arch length to fit to standardized shoe sizes [@ASTM2017].
Furthermore, terrestrial footwear is commonly designed around lasts, shoe molds that are sized and shaped by each manufacturer with no common standard.
This leads to variability in footwear shapes and sizes [@Jurca2013; @Wannop2019], making it hard for consumers to find a proper fit and resulting in users having to wear ill-fitting footwear with suboptimal comfort and being at risk of occupational injury during ambulation [@Dobson2018b]. 
Footwear fit and comfort has shown benefits in increasing biomechanical performance [@Pryhoda2021], reducing the risk of movement-related injury [@Mundermann2001a], and is often the number one factor for consumers to select footwear [@Martinez-Martinez2017]. 
Therefore, the issue of footwear fit and comfort is not just limited to spacesuit boots, both terrestrial footwear and spacesuit boots should account for the wide variety of foot shapes to improve fit. 

In addition to foot shape variability in the population, the foot also changes shape while being loaded during gait. 
The current methodology of designing terrestrial footwear uses static lasts, assuming that the foot consists of rigid segments.
Assumptions of rigid foot segments during foot loading have shown inaccuracies in estimation of ankle joint mechanics [@Zelik2018; @Kessler2020].
Evidence has been presented on articular motion within the foot as it is loaded [@Lundgren2008; @Wolf2008], and that foot loading affects linear foot measurements, such as when transitioning from sitting to standing [@Xiong2009; @Oladipo2008] or during the stance phase of gait [@Kouchi2009; @Barisch-Fritz2014; @Grau2018].
The dynamically changing measurements suggest morphological changes occurring, all of which may not be captured in static linear and circumferential measurements. 
Thus, footwear should also be designed to account for these dynamic foot shape changes. 

Statistical shape models (SSMs) can explain morphological differences across populations and during motion by identifying shape modes which account for variance from the mean shape. 
These have been developed for whole-body digital human modeling applications to study population and individual variance in body shape [@Allen2003; @Anguelov2005; @Reed2014; @Park2015a; @Park2017]. 
Parametric SSMs are extensions which use correlations between subject anthropometric data and SSM deformations to help predict body shape for new individuals in the population [@Park2015a; @Park2017]. 
The ABF at NASA developed parametric SSMs to characterize shoulder shape deformation across the shoulder's range-of-motion, predicting shape as a function of shoulder orientation, to validate HUT design [@Kim2016;@Kim2019].
However, the technology used to capture the body scans for this SSM could not capture the dynamic natural motion of the shoulder; subjects had to pose their shoulder at specific orientations while a scan was taken. 

The aforementioned efforts to capture foot measurement changes over the gait cycle did capture 4D foot images [@Barisch-Fritz2014;@Grau2018], but these efforts focused on extracting changes in foot measurements and not volumetric predictions of foot shape. 
SSMs have recently been applied to characterize static foot shape across a population [@Conrad2019] and recognize foot-shape deviations [@Stankovic2020;@Schuster2021], but these efforts were not predictive. 
Previously developed systems were based on a catwalk, requiring subjects to correctly hit the scanning area for a successful data capture, which may not be representative of natural cadence. 
However, the systems used to capture 4D foot shape are very expensive and cannot be used around a treadmill, which allows for subjects to fall into natural gait.
Therefore, no SSMs have been developed from previous capture of 4D foot scans to predict dynamic foot shape. 

Therefore, this specific aim first developed a low-cost 4D scanning system to capture foot shape while subjects walked on a treadmill.
A predictive statistical shape model of foot shape changes was then developed from this data, which identified foot shape changes during gait. 
A further investigation into the correlation of instep shape changes against static foot anthropometries was carried out in order to further inform footwear design. 

## DynaMo: Dynamic Body Shape Capture with Intel RealSense Cameras

A low-cost 4D scanning system, DynaMo, was developed to capture dynamic foot shape during gait. 
Human body shape can be captured with a variety of methodologies, including laser lines, structured light, photogrammetry, and millimeter waves [@Daanen2013].
However, these technologies require expensive modules and have limited ability to capture dynamic changes in body shape. 
Motion capture with specific markers is commonly done through camera-based motion tracking [@Windolf2008]
These systems for marker tracking are often cost prohibitive and unable to capture surface morphology.

Therefore, the DynaMo software library was developed to use multiple commercial depth cameras, the Intel RealSense DXX Depth Cameras (Intel, Santa Clara CA), retailing between $150-$200, to capture dynamic body shape changes. 
The Intel RealSense Depth cameras use two stereo image sensors along with a structured light projector to capture depth maps at 90 frames-per-second; each pixel in a depth map records the distance from the camera to the world.
DynaMo includes functions to calibrate a capture volume, using a checkerboard to identify a common origin between multiple depth cameras ([@fig:testSetup]). 
DynaMo calculates a common point cloud from the depth maps of all the connected cameras, outputting a point cloud for every frame captured by all connected cameras ([@fig:SA2-sampleFrames]). 
Functions were also developed to track the position of reflective markers in the scene.
The development of DynaMo was published in a journal paper [@Boppana2019].

![Capture setup of 6 Intel RealSense D415 Depth Cameras (circled in red) placed around a treadmill. The checkerboard shown was used to calibrate the cameras using the DynaMo package.](../fig/SA2/capturesetup.png){#fig:testSetup width="50%" short-caption="Capture setup of 6 Intel RealSense D415 Depth Cameras placed around a treadmill."}

![Sample frames, shown in 10 frame intervals (bottom), collected by DynaMo showing dynamic shape capture of the foot (top) at 90 frames-per-second, and the capture of reflective markers on the foot shown as white dots](../fig/SA2/sampleFrames.png){#fig:SA2-sampleFrames width="80%" short-caption="Sample frames collected by DynaMo showing dynamic shape capture of the foot at 90 frames-per-second."} 

A post-hoc accuracy analysis was conducted on the DynaMo software and Intel RealSense D415 cameras. 
A shoe last with a corresponding 3D digital model was placed in the capture volume between all cameras, and scanned 10 times. 
The last was removed and replaced in the volume between each scan. 
Root-mean-squared error was then calculated between each resulting 3D scan, and the 3D digital model, and was found to be 2.5 $/pm$ 0.5 mm. 

## Development of a Predictive Dynamic Foot Shape Model from Statistical Shape Modeling

The DynaMo software [@Boppana2019] allowed for a capturing of foot shape to develop a parametric SSM.
This system captures  foot morphology changes during loading and unloading on the foot's dorsal surface, but does not capture of the foot's plantar surface. 
A parametric SSM was developed which can characterize and predict dynamic foot morphology at specific points during stance phase across the subject population. 

### Methods

#### Subjects

A total of 30 healthy subjects (15 men and 15 women, ages 23.1 $\pm$ 3.7) participated in this study.
Subjects were recruited in a stratified sample into one of six groups (5 subjects per group) to maximize variance in population foot length. 
Height was used as the grouping factor since height is well correlated to foot length [@Giles1991]. The general population may not know offhand their exact foot length, and shoe size varies by manufacturer and does not correspond directly to foot length [@Jurca2013; @Wannop2019]. Groups consisted of 5th-35th, 35th-65th, and 65th-95th height percentiles for each sex. 
Height percentile values were taken from the ANSUR II survey [@Gordon2014].
Population recruitment groups are summarized in [@tbl:groups].  

| Sex    | 5th-35th percentile Height | 35th-65th percentile Height | 65th-95th percentile Height |
| -------| -------------------------- | --------------------------- | --------------------------- |
| Female | 4'11"-5'3"                 | 5'3"-5'5"                   | 5'5"-5'8"                   |
| Male   | 5'4"-5'8"                  | 5'8"-5'11"                  | 5'11"-6'2"                  |

: Enrollment groups based on reported height. 5 subjects were enrolled in each group {#tbl:groups}


Prior to recruitment, subjects completed a prescreening survey to ensure they were adequately healthy by the American College of Sports Medicine guidelines [@Riebe2015], and between the ages of 18-65.
Subjects provided their sex and height, and were only enrolled in the study if their population group was not fully enrolled. 

#### Experimental Procedures

The experimental protocol was approved by the University of Colorado Institutional Review Board.
Procedures were explained to each subject and written consent was obtained prior to participation. 
Subjects’ height and weight were recorded with a tape measure and scale, respectively. 
Subjects’ foot length, foot width, and arch length were measured with a Brannock device (The Brannock Device Company, Liverpool, NY) [@ASTM2017].
Both foot length and arch length were measured in centimeters.
Foot width was measured as an ordinal size (e.g. A, B, C, D, E), and then converted to a linear measurement in centimeters (The Brannock Device Company, Liverpool, NY).

Six Intel RealSense D415 Depth Cameras (Intel, Santa Clara, CA) were placed and calibrated around a custom-built level treadmill in the University of Colorado Boulder Locomotion Laboratory, as shown in [figure @fig:testSetup].
The treadmill was set to an average walking pace of 1.4 m/s [@Browning2006].
Reflective markers were placed on the subject's right foot and a black sock over their left foot to aid in right foot identification.
Subjects first walked for one minute to warm-up and fall into a natural cadence. 
The operator then collected 10 seconds of data to capture approximately 10 steps.
The data were reviewed to ensure the subject stayed in frame from heel-strike to toe-off during capture. If needed, the subject’s placement was shifted and data was collected again, up to two times.

#### Data Processing

[Figure @fig:dataflow] provides an overview of the data processing workflow; all steps are summarized in the paragraphs below. 

![Flowchart of processing steps for statistical shape model creation](../fig/SA2/footProcessing.png){#fig:dataflow width="100%"}

For each subject, a single candidate heel-strike to toe-off event was manually identified across all captures by taking into account point cloud quality due to the high computational power required to process all heel-strike to toe-off events. 
Events with holes greater than 1cm that appeared across more than one frame were rejected. 
The depth images captured by each depth camera were processed into point clouds using the DynaMo package [@Boppana2019].

From each point cloud, the right foot was isolated and transformed into a triangle mesh.
The C++ implementation of the PointCloud Library [@Rusu2011] was used to identify and isolate the right foot from the point set. 
First, the point clouds were downsampled with a voxel size of 3 mm to reduce required computing power. 
A random sample consensus (RANSAC) algorithm [@Fischler1981] was used to identify the flat treadmill floor with a plane model, and remove it from the point cloud. 
Euclidean cluster extraction was then used to detect the point clusters that make up each foot.
The total color value of each point cluster was used to identify the right foot from the left foot, as the left foot had a lower total color value due to the black sock. 
The left foot was then removed from the point cloud, leaving only the right foot for processing. 

Poisson surface reconstruction was done using Open3D [@Zhou2018]; this adds a topological layer interpreted from the pointcloud.
Point normals were calculated for the point cloud using the 10 nearest neighbors. 
A ball-pivoting algorithm [@Bernardini1999] is then used with the point normals to estimate the surface from the point cloud and construct the foot scan mesh. 

Since every depth image was captured independently by the cameras, the amount and location of points which represented the foot were not consistent. 
Registration of all scans to a common template represents every scan by an equal number of points, and ensures any missing points not meeting the rejection criteria are properly interpolated. 
The right foot meshes were then iteratively registered using a three-step fitting process to an averaged high-quality static template scan, provided by Dr. Matthew Reed from the University of Michigan Transportation Research Institute [@Reed2013].
From the provided template, the toes were smoothed into a single structure and parts of the upper shank removed to be better fit to the captured data, with a finalized structure of 29873 points. 
The overall registration process follows a three-step process: a rough alignment followed by two radial-basis function (RBF) fine alignment steps

The registration process was first completed for each subject's data with a foot scan mesh manually identified near mid-stance. 
A point-to-plane iterative-closest-point (ICP) algorithm [@Chen1992] was used to roughly align the template foot to the scan mesh with the Open3D library [@Zhou2018]. 

Corresponding points between both the scan mesh and the ICP-aligned template were found using a radial-search KD-Tree implemented in the Open3D library [@Zhou2018]. 
Any points on the scan mesh which were not within 1 cm of a corresponding point on the aligned template were deleted; these points represented parts of the treadmill floor which were missed in the RANSAC identification and parts of the upper shank. 
Similarly, any points on the template not within 1cm of a corresponding point on the scan mesh were temporarily set aside from the template; these points correspond to those near holes in the scan mesh which would be refilled in later processing

Thin-plate spline RBFs have been used to surface fit templates to scanned body shapes [@Park2015a], and so were used in two stages in this research. 
A first-pass RBF registration, using a thin-plate spline for interpolation, was done between the template and the scan using the GIAS2 package [@Zhang2016]
To prevent overfitting of the RBF to the noise on the edges of the captured pointcloud, a maximum of five iterations were done on the first-pass RBF registration process. 
The first-pass registered RBF template was then appended with the points previously removed from the template. 
This intermediate template represents the template fitted to the known scan data, with any unknown sections (e.g. holes in the scan data), taking the value of the template. 
However, the disparity between the known and unknown sections created major discrepancies in the morphed template not representative of the scan data. 

A second-pass RBF registration was done from the ICP-aligned template to the intermediate template with the same parameters as the first-pass registration.
This smooths out the unknown sections representing holes in the scan data with the surrounding known sections. 
The second-pass registered template was saved as the final registered template. 

Following the registration of the mid-stance scan, the process was repeated both forwards towards toe-off and backwards toward heel-strike on a scan-by-scan basis.
In this iterative fashion, the previous scan’s registered template was used as the template for the following scan. 
During the iterative registration process, the RBF alignment was only conducted for one iteration for both the first-pass and second-pass to prevent over-fitting.

Anatomical landmarks were approximated from the registered scans using the foot features of the registration template [@VandenHerrewegen2014b]. 
The original template identified the lateral malleolus, medial malleolus, 1st metatarsal head, 5th metatarsal head, and 2nd toe landmarks as certain vertices. 
New landmark vertices for the lateral shank and medial shank were manually picked on the template. 

Post-registration scans were aligned to a common coordinate frame based at the toes.
The origin was defined as the point along the vector from the 1st metatarsal head landmark to the 5th metatarsal head landmark which is orthogonal to the second phalange. 
From the origin, the x-axis, was defined as pointing towards the 2nd toe.
The y-axis, was pointed towards the 5th metatarsal. The z-axis was the cross-product of both x- and y-axes, pointed upward. 
This coordinate system also served as the static coordinate system for the MTP joint. 

The ankle joint center was defined as the midpoint between the medial and lateral malleolus. 
The ankle's local z-axis is aligned vertically with the shank center, defined as the center between the lateral shank and medial shank landmarks. 
The ankle's local y-axis is aligned from the shank center to the lateral malleolus. 
The ankle's x-axis is the cross-product of the y- and z-axis, pointed in the forward direction towards the toes.

Static reference angles were taken from these coordinate systems at mid-stance. 
For the ankle joint, the z-axis served as the internal/external rotation axis, the y-axis as the dorsi/plantarflexion axis, and the x-axis as the inversion/eversion axis.
Since the model's origin was at the toes, the calculation for MTP dorsi/plantarflexion was modified. 
The new local MTP joint coordinate system had the x-axis defined as pointing from the ankle joint center to the MTP joint center, as such the y-axis represented MTP dorsi/plantarflexion. 
Since there is little flexibility in the transverse and frontal planes of the MTP joint, the x-axis therefore represented whole foot inversion/eversion,  and the z-axis represented whole foot internal/external rotation around the origin. 
MTP and ankle joint angles were calculated for every other scan as the Euler angle difference from the static joint coordinate system around each axis. 
Each subject's joint angles are low-pass filtered with a 2nd order low-pass Butterworth filter with a cutoff frequency of 15 Hz. 
The global and local coordinate systems are summarized in [@fig:SA2-angles].

![Coordinate system defined from registered scans. Anatomical landmarks are shown as black dots. The ankle joint's local coordinate system is shown in blue, the MTP joint's local coordinate system is shown in yellow, and the model's origin coordinate system is shown in red. Directions for each coordinate system are shown in bold text](../fig/SA2/foot_cord.png){#fig:SA2-angles width=90% short-caption="Coordinate system defined from registered scans."}

#### Model Construction

Principal component (PC) analysis is a dimensionality-reduction method commonly in constructing SSMs [@Reed2008; @Park2015a; @Conrad2019; @Stankovic2020].
The first PC represents an axis containing the largest variance in the dataset, and each subsequent PC describes the largest variance orthogonal to the previous component's axis. 
Therefore, PCs allow for a new, smaller set of orthogonal variables to be defined which represent the variance in the dataset.

Let $N$ equal the number of total scans in the dataset, and $n=29873$ equal the number of vertices in each registered scan. The scikit-learn module [@JMLR:v12:pedregosa11a] was used to incrementally calculate the maximum $N$ PCs which represent the dataset.
Each scan in the dataset is represented in the PC model with $N$ PC scores. 
All PC scores are centered around 0, which represents the mean foot scan of the dataset containing all subjects. 
Each PC represents a shape mode in the SSM, where each score represents a deviation from the mean foot along the shape mode axis. The resultant PC model can be used to inverse transform a vector of length $N$ PC scores into a $29873\times 3$ vector, which represents the location of the vertices in the foot shape. Not all PCs were retained in the model since the first few PCs explain a majority of the variance, while additional PCs may be accounting for noise.

Subject demographic data and calculated joint angles were incorporated into the SSM by developing multivariate linear regression models based on these features. 
This was used to predict each PC score, which can then be inverse-transformed into a foot shape.
Subject demographic data and joint angles were independently unit normalized and power-transformed across the whole dataset to aid in regression development [@Yeo2000].
An elastic net regularization algorithm [@Zou2005] was run for each multivariate regression to calculate normalized feature coefficients for each PC score's regression. 
Two different sets of predictors were created, one with all subject demographic data and calculated joint angles, and one with the highly cross-correlated predictors of arch length, body-mass index, and height were removed. 
Six potential models were built as combinations between the number of PCs predicted which explained 95%, 98%, and 99.7% of the variance, and the two predictor sets. 


#### Model Validation

All six models were validated for performance using leave-one-out cross-validation, where scans from each subject were set as the validation set, and models were trained on the remaining dataset. 
Model performance during validation was quantified with the root mean squared error (RMSE) and Hausdorff distances of the predicted foot shape to the corresponding registered scan. 
A two-way RMANOVA analysis was run on the error distributions to test the effect of constructing a predictor with the different number of PCs, and between using the two variable sets. 
The chosen model was retrained on the whole dataset before being analyzed. 

### Results

A total of 1771 scans were analyzed across all 30 subjects. 
The average number of scans collected for each subject's stance phase was 59 $\pm$ 3.7, with a range of 52-69 scans due to inter-individual differences in stride length. 
[Figure @fig:scans] shows a set of raw and registered scans from one subject.
All processed scans were registered to the template with a mean registration RMSE of 1.0 $\pm$ 0.6 mm, and a mean Hausdorff distance of 25.5 $\pm$ 13.4 mm.

![Processed and registered scans of one subject during heel-off, shown 10 frames (0.11 seconds) apart.](../fig/SA2/scans.png){#fig:scans width="80%"}

The PCA analysis of all registered scans found the first 8 PCs to represent approximately 95% of the variance, the first 27 PCs to represent approximately 98% of the variance, and the first 105 PCs to represent approximately 99.7% of the variance. 
([Figure @fig:modelperf]) shows the distribution of cross-validation RMSEs and Hausdorff distances for each of the six models tested. 
Aligned-Rank Transform [@Wobbrock2011] was used to compare models as error distributions did not meet assumptions for normality. 
Significant differences were found in RMSE and Hausdorff distances between predicting different numbers of PCs (RMSE: F=7037, p<0.001; Hausdorff distances: F=4577, p<0.001), predicting between the two variable sets (RMSE: F=6.4, p=0.012; Hausdorff distances: F=4.4, p=0.036), and for the interaction (RMSE: F=3.0, p=0.05; Hausdorff distance: F=5.3, p=0.005). 
An ART-C post-hoc test [@Elkin2021] with Bonferroni correction found significant differences between all but one pair of models; detailed results are presented in supplementary information. 
Therefore, the model predicting 8 PCs with the selected variable set was chosen for its simplicity and performance. 

![Distribution of mean root-mean-square (RMSE) error and mean Hausdorff distance (HD) across the various prediction models leave-subject-out cross-validation results. Model error values and standard deviation are shown below each distribution](../fig/SA2/modelPerformance.png){#fig:modelperf width="80%" short-caption="Distribution of mean root-mean-square (RMSE) error and mean Hausdorff distance (HD) across the various prediction models"}

Each retained PC is a shape mode.
([Fig. @fig:SA2-coefs]) shows the chosen model's normalized regression coefficient values for each shape mode. 
The coefficients for the sex predictor are not shown as they were predicted to be zero for every shape mode.


![Each graph represents the predictor's effects on the shape mode by visualizing the model's normalized coefficients. Larger absolute values indicate a larger effect from the predictor on the shape mode.](../fig/SA2/coefs.png){#fig:SA2-coefs width="100%" short-caption="Foot shape model's normalized coefficients"}


[Figure @fig:pca_overlay] shows each shape mode's axis represented on the mean foot, highlighting which areas of the foot are affected by deformations in each shape mode, and the $\pm$ 2 standard deviations of deformation along each shape mode overlaid on the mean foot. 
Supplementary information includes correlation between predictors, ratio of total variance each retained PC accounts for, and a link to an interactive web tool to visualize the model.
All data from this project is available online.




![A: Each shape mode's principal axis represented as a heatmap overlaid on the mean foot and shown from 4 different point-of-views. The darker regions represent vertices which are most correlated with the shape mode's principal axis, and therefore see deformations in the shape mode. B: Foot shape deformation at +2 and -2 standard deviations along each shape mode's principal axis, overlaid on the mean foot. The point-of-view is set to highlight the major variance along each shape mode's axis.](../fig/SA2/PC_Var_Quad.png){#fig:pca_overlay width="95%" short-caption="Shape mode variance locations and magnitude"}

### Foot Shape Changes

This study was designed to construct and evaluate a parametric SSM in explaining and predicting dynamic foot morphology changes across the subject population. 
The model was able to predict dynamic foot shape across the subject population with an average RMSE of 5.2 $\pm$ 2.0 mm and mean Hausdorff distance of 21.4 $\pm$ 7.4 mm. 
The disparity between RMSE and Hausdorff distance is due to scan edges, which have inherently high noise from depth camera capture. 
For context, if all possible RMSE prediction error was accumulated to only affect length and width, it would be higher than the half-size step of the American shoe sizing system [@Luximon2013], but less than inter-brand variability of shoe length and shoe width [@Wannop2019].
Further, this error is lower than the RMSEs of other parametric SSMs that predicted static standing child body shape (mean=10.4mm) [@Park2015a], dynamic shoulder deformation (mean=11.98mm) [@Kim2016] and child torso shape (mean=9.5mm) [@Park2017]. 
Note though, that the presented model may have lower prediction errors due to the foot being a relatively smaller section of the body to model.
Grant et al's model reconstructed internal foot bones with much lower RMSEs and Hausdorff distances from sparse anatomical landmarks (RMSE: 1.21-1.66 mm, mean Hausdorff: 3.21-7.19 mm) [@Grant2020] but was trained with higher resolution MRI images. 
Other efforts to create statistical foot shape models did not incorporate parametric prediction of foot shape [@Conrad2019; @Stankovic2020]. 

Foot motion during stance is dominated by MTP and ankle dorsi/plantarflexion [@Leardini2007], captured in the first shape mode ([@fig:pca_overlay]).
Shape changes in frontal and transverse planes are captured in the second and fourth shape modes, respectively ([@fig:pca_overlay]). 
Movements captured in these shape modes are well correlated to the expected movement of foot during stance phase [@Leardini2007]. 
The second and fourth shape modes are slightly affected by foot length, which may suggest inter-individual effects in foot inversion/eversion, ankle inversion/eversion, and internal/external rotation during gait.
There is a slight correlation between these angles and foot length (see supplementary figures), which may be due to differences in cadence when walking at the treadmill's set speed.
Individuals were given time to acclimate to the treadmill's set speed, but the speed may not have been their preferred walking speed. 

Foot length scaling is captured in the third shape mode ([@fig:pca_overlay]). 
Foot length shrinks when moving positively along the third shape mode ([@fig:pca_overlay]), and thus has a negative effect from foot length.
Negative effects from foot width and weight may be due to their correlation to foot length (see supplementary figures).

Longitudinal arch height is a significant factor in static [@Stankovic2020; @Conrad2019] and dynamic foot shape [@Schuster2021] . 
Due to limitations in the field-of-view of the cameras around the treadmill, arch height was not able to be directly measured. 
However, the instep area was found to rise along the fifth shape mode's axis ([@fig:pca_overlay]), which is representative of the longitudinal arch apex. 
This was positively affected by foot length and negatively by MTP dorsi/plantarflexion ([@fig:SA2-coefs]), suggesting that the instep height increases with foot length, and decreases through heel-off as the MTP dorsiflexes. 
Jurca et al. found a similar relationship between static instep height and foot length, although there is still a wide variety of instep height in the population [@Jurca2019].
The drop in instep height is most likely related to the decrease in medial-longitudinal arch (MLA) angle, attributed to the windlass mechanism and measured through radiographs and optical motion capture [@Hicks1954;@Caravaggi2010;@Stolwijk2014]. 
Similarly, midfoot girth was previously found to decrease during stance phase compared to statically standing when taking this measurement over dynamic foot scans [@Grau2018]. 
The presented model provides volumetric insight into where the drop in instep height occurs by identifying it in a shape mode, as well as allowing for its predictability from foot length and MTP dorsiflexion. 

The heel was found to vary in the third and fifth shape mode's axis, varying from a rounded to a sharper shape along both axes. 
As the heel lifts off the ground at heel-off, the soft-tissue unloaded during gait and changes morphology [@Fontanella2013].
At heel-off, there is foot eversion and MTP dorsiflexion [@Leardini2007], explaining the negative effects on the third and fifth shape modes, respectively ([@fig:SA2-coefs]).

Girth changes at the ankle, midfoot, and medial MTP joints are captured in the second and sixth shape modes ([@fig:pca_overlay]). 
Girths increase just prior toe-off with ankle internal rotation in the sixth shape mode, and eversion in the second and sixth shape modes ([@fig:SA2-coefs]).
Girths are also increased with increased subject weight. 
The foot is stiffened through tension in the MTP joints in order to prepare for toe-off [@Hicks1954], and the MTP joints are known to move relatively within the foot during gait [@Wolf2008; @Lundgren2008] which may be resulting in the increased girth at the MTP joint. 
A similar mechanism may be occurring at the ankle joint during ankle inversion and internal rotation, where tension from muscle activation prior to toe-off may cause increased girth.

The model can inform last and footwear design recommendations for increased fit and comfort.
Lasts are typically designed to shape the shoe for both fit and fashion, and are derived from static foot dimensions for a given size [@Luximon2013]. 
Previous work has proposed the use of 3D foot scans to inform last design [@Sambhav2011], and even generate predicted individual shoe lasts [@Amza2019]. 
The 3D meshes predicted by the model can generate lasts in various size grades and representative of shape changes during stance phase.
For example, lasts can be constructed with a deformable or removable instep area, matched to the model's predicted reduction in arch height for a given foot length. 
Lasts could also feature a swappable heel element to ensure that rearfoot morphology is accommodated as the heel is off-loaded. 
Digital footwear design tools could also directly import the predicted meshes generated from this model for virtual fit tests: interaction models between the footwear design and the dynamic foot shape could ensure fit is consistent through motion. 
Shape changes identified from this model can also inform footwear design. 
For example, the instep height drop may be accommodated with tensioned lacing, ensuring the foot is captured and cannot shift upward inside the shoe during heel-off. 
In addition, a heel counter can secure the changing morphology of the heel during heel-off, preventing heel rise within the shoe. 
While such elements are already found in many commercially available shoes, the presented model validates their importance and provides a framework for iterating on their design. 

### Study Limitations

A number of limitations in this study should be noted. 
The elastic-net method is able to retain cross-correlated predictors, but still requires some bias in the dataset to predict scenarios where cross-correlated predictors are independent  [@Zou2005].
Therefore, the presented model may not be valid for predicting changes in morphology from independent changes in joint angles outside of stance phase, or from variance in foot width or weight compared to foot length not captured in the subject population. 
The model did not capture sex differences in foot shape; studies found that these differences after scaling for foot length were not significant [@Kouchi2009; @Barisch-Fritz2014a; @Conrad2019], or were small in magnitude [@Wunderlich2001;@Krauss2008].
No data was collected to analyzed foot shape differences due to ethnicity [@Jurca2019].
Data at the toes was noisy, necessitating smoothing the template's toes to ease fitting.
Plantar foot shape was not captured, which is also known to vary with foot shape and loading   [@Mei2020].
Future advances in scanning technology may improve data quality and allow for capture of arch shape and plantar shape for further analysis. 


### Study Conclusions

The observed girth changes at the ankle joint, medial malleolus, midfoot, and MTP joint can be directly mapped to spacesuit footwear design recommendations to reduce instances of heel-lift. 
During heel-lift, the heel rises inside the boot, resulting in the midfoot rotating upward around the MTP-joint much like after the heel-off phase in gait. 
This can only occur if there is empty space above the midfoot; if the boot's internal shape were perfectly fit to the foot's shape, the foot would not be allowed to move inside the boot. 
Unlike some terrestrial footwear which can rely on the elasticity of uppers to continuously capture the foot, the stiff nature of a pressurized spacesuit boots does not allow for its upper to continuously conform to the foot if the foot changes shape. 
The study showed that midfoot girth decreased as the MTP joint is dorsiflexing after heel-off in the fifth shape mode. 
Therefore, a spacesuit boot should have a mechanism to conform to this volume change to reduce empty space above the midfoot and therefore reduce instances of heel-lift. 
Heel counters are also designed into many terrestrial boots to ensure the heel stays index through motion; a well-designed heel-counter could also help reduce heel-lift.
Rearfoot morphology changed from a rounded shape to a sharper shape with MTP joint dorsiflexion in the fifth shape mode, suggesting that a heel-counter may need to account for this shape change to properly capture the heel. 
A combination of midfoot capture and an improved heel-counter that account for these morphological changes can work together to reduce instances of heel-lift in the spacesuit boot.

## Analysis of Dynamic Instep and Arch Height Changes

The dynamic foot shape model provides insight into how regions of the foot change shape due to motion or anthropometry.
One of the primary findings from the model was the decrease in arch height during stance phase, following by an increase through heel-off.
However, the nature of a SSM is that it only outputs foot shapes and not linear or circumferential foot measurements. 
Therefore, the magnitude of arch height change was not characterized in this model.
Characterizing arch height changes will assist in the spacesuit boot design, as this measurement will provide a baseline for engineering a conformable upper which reduces empty space above the midfoot and thereby may reduce heel-lift. 

Arch height, however, is not a primary measurement in terrestrial footwear fit. 
Lasts are traditionally made in a single reference size, and then either geometrically, arithmetically, or proportionally scaled larger and smaller to match other user sizes based on foot length [@Luximon2013].
This process results in other foot dimensions being scaled with the same proportion as foot length. 
However, arch height has little correlation with foot length [@Hill2017].
Arch height is not a measurement used in the grading of shoe sizes, as such customers are not able to select shoes which fit their arch with quantitative fit metrics.
Instep height, which is taken near the foot’s arch, may be targeted in last design, but is also not used in grading.
Furthermore, foot measurements defining shoe sizes are taken statically, and do not account for the dynamic changes in foot shape due to the foot’s loading during gait.

The arch changes shape dynamically during gait, thus exacerbating difficulty in accommodating its shape during movement. 
Medial longitudinal arch (MLA) shape changes are thought to be caused by several mechanisms. 
Hicks used radiographs to show that the foot’s arch drops and decreases in angle while it is loaded during early and mid-stance, and rises and increases in angle during late stance [@Hicks1954]. 
They hypothesized that a stiff plantar fascia results in a windlass mechanism, where the plantar fascia is pulled towards the toes as the toes dorsiflex during late stance phase. 
This shortens the arch and raises its height. 
Additionally, Ker et. al hypothesizes that the arch behaves like a spring, where it is compliant and stiff during early and mid-stance, and then recoils in late stance to increase in height and assist in propulsion [@Ker1987]. 
They also observed this arch height drop during early and mid-stance. 
Similarly, optical motion capture techniques have shown that the MLA angle increases and arch height drops in during early and mid-stance, followed by the MLA angle decreasing and arch height rising in late-stance [@Caravaggi2010; @Cashmere1999; @Leardini2007; @Stolwijk2014]. 
The arch’s dynamic motion can be attributed to a combination of the windlass and arch-spring mechanisms, providing a physical explanation to the arch’s dynamic motion [@Welte2021; @Welte2018]. 
The rise and fall of the arch are reflected as shape changes in the foot’s instep area; this was found to be the largest variation in foot shape between loaded and unloaded feet [@Schuster2021]. 

Customers aiming to find footwear that fits their foot shape may face difficulties due to the lack of arch or instep height as a fit metric and the dynamic nature of the arch itself.
Arch and instep height variation can be accommodated for in footwear through lacing and upper design.
Customers therefore may need to try on various shoes while searching for an upper design that matches their arch and instep height. 
Customers may also adjust the fit of the arch and instep in each shoe they try on with lacing until they are satisfied with their fit. 
Lacing modifies how the shoe’s upper sits on the wearer’s foot, frequently implemented above the wearer’s arch and instep. 
Lacing may be a key tool in reducing heel-lift in the spacesuit boot, as it can help secure the foot inside the shoe. 
Lacing can provide a level of customization to arch and instep fit, especially when compared to an elastic shoe upper [@Hong2011]. 
Proper lacing can also ensure comfort and performance during activities [@Hagen2009; @Hagen2010; @Pryhoda2021]. 
Furthermore, tensioned lacing could be used to ensure that dynamic fit is maintained as the arch moves through gait [@Pryhoda2021]. 
Investigating how both static and dynamic arch height may relate to other foot measurements could improve footwear design, such as by scaling lasts more accurately to accommodate arch height and provide customers with a guide in selecting shoes that fit all aspects of their foot shape. 

To address this gap in footwear design, understanding the magnitude of foot shape changes at the arch may be used. 
The arch sits at the middle of the foot, just under the instep region. 
Therefore, it is expected that any change in arch height and MLA angle would affect instep height.
There is also opportunity to investigate if dynamic arch height changes are affected by the subject’s static foot measurements, and if the instep height measurement is analogous dynamically to the arch height measurement.
The objective of this research is to evaluate whether dynamic instep height changes can be correlated to static foot measurements. 
This research hypothesizes that 4D scanning can be used to quantify instep height changes, and that dynamic instep height change is correlated to static instep height, foot length, and foot width. 

### Methods
Instep height measurement was evaluated as an appropriate measure to assess static and dynamic arch height in static scans. 
A strong correlation between these measurements allows for comparison to arch height measures since instep height is measured near the location of the MLA. 
Instep height measurements were first correlated to arch height measurements using a subset of the 3D static foot scan measurement dataset from [@Jurca2019] (Swedish Ethics Review Authority reference No. 2019-03243).
The dataset was down-sampled to only include length classes in the 4D scan dataset used for the aforementioned dynamic foot shape model. 
Instep height measurements were taken for each foot scan by taking the height of the frontal cross-section at 55% of foot length from the heel [@Jurca2019]. 
Arch height measurements were taken at the frontal cross-section at 45% of foot length from the heel [@Jurca2019]. 
From this cross-section, the height from the ground to the foot is taken at 25% of the foot’s width at this cross-section from the lateral side. 
Pearson correlation coefficients were computed between the instep height and arch height within this dataset. 


As the 4D foot scans did not include the foot’s plantar surface, a new method for measuring instep height was defined, summarized in [@fig:instepMeas]. 
A virtual landmark, labeled as the middle metatarsal head, was defined as halfway between the medial and lateral metatarsal heads. 
Then, a triangle was defined on the scan’s sagittal plane, with its base defined as the vector from the pternion to the middle metatarsal head. 
The triangle’s height was defined as the orthogonal distance from this vector to the instep landmark; this height was recorded as the scan’s instep height. 
While the instep height landmark may not be perfectly aligned with the pternion-middle metatarsal head vector, this method ensures that the instep height measurement is always taken perpendicular to the base of the defined triangle in the foot’s sagittal plane. 
Despite the data set limiting the measurement technique from following the traditional methods of measuring instep height from the literature [@Jurca2019], this method does represent the height of the foot at the instep area when the plantar surface of the foot is not available as a reference. 

![Landmarks and vectors used for instep height measurement, shown in top and side views. The principal foot axis is defined from the pternion to the middle metatarsal head landmark (top). A triangle is defined with a base between the middle metatarsal head and the pternion, and an upper vertex at the instep landmark (bottom). The height of this triangle (red) is taken as the instep height. The MLA location is also shown for comparison.](../fig/SA2/instep_Meas.png){#fig:instepMeas width="80%" short-caption="Landmarks and vectors used for instep height measurement, shown in top and side views."}


For each subject, the instep height measurement over stance phase was filtered with a 2nd order Butterworth low-pass filter, with a cutoff of 15 Hz, to reduce measurement noise. 
Mid-stance instep height was defined as the instep height taken halfway between heel-strike and toe-off for all subjects, representative of the static instep height. 
The late-stance instep height measurement was noted as the highest instep height measurement between mid-stance and toe-off. 
The difference between these two instep height measurements was calculated for each subject as the dynamic instep height change. 
The correlation coefficient was computed for each scan within each subject between instep height and MTP joint angle. 
The MTP joint angle was chosen for correlation analysis as the hypothesized windlass mechanism for arch height rise is dependent on the MTP joint angle [@Hicks1954].
Correlation coefficients were also computed between all subjects’ dynamic instep height change and their foot lengths, foot widths, and static instep heights. 
Subjects’ maximum instep height changes were compared to subjects’ foot lengths, foot widths, and static instep heights to identify if there are any trends which predict the maximum instep height change.

### Results
Analyzing Volumental’s static scans found a correlation coefficient of 0.70 and 0.71 was found between instep height and arch height for females and males, respectively. 
Instep height was calculated for subjects with dynamic scans and compared to their MTP joint angles. 
The relationship between selected subject’s MTP joint angle throughout stance phase, and their measured instep height, is shown in [@fig:instepCorr]. 
For most subjects, the instep height drops from early to mid-stance, and then rise in late stance with the MTP joint angle. 
Correlation coefficients between the calculated instep height and MTP joint angle from dynamic scans for each subject are also noted in [@fig:instepCorr]. 
Twenty-five of the thirty subjects had high correlations ($r^{2}$=0.73±0.10) between their instep height and the MTP joint angle. 
These subjects had a mean instep height difference of 15mm±4mm. 
The remaining five subjects (Subjects 2, 16, 21, 22, and 29) had low to no correlation ($r^{2}$=0.11±0.36) between their instep height and the MTP joint angle across the gait cycle. 
These subjects’ data was manually examined for anomalies, but none were found.

![Correlation between selected subjects instep height and MTP joint angle over stance phase. Subjects with high correlation between their MTP joint angle and instep height are shown on the top row. Subjects with lower correlations between their MTP joint angle and instep height are shown on the bottom row. Locations of where mid-stance and late-stance instep height values are taken for each subject are highlighted as vertical lines. The Pearson correlation coefficient for each subject is shown on their graph.](../fig/SA2/instep_MTP.png){#fig:instepCorr width="80%" short-caption="Correlation between selected subjects instep height and MTP joint angle over stance phase. "}

Maximum instep height change was found to be 53.7 ± 4.4 mm for the 25 subjects with high correlations between instep height change and MTP joint angle. 
[@tbl:corrs] shows the correlation coefficients between the maximum instep height changes and foot length, foot width, and static instep height for these subjects.

| Anthropometric measurement    | Correlation to maximum instep height change |
| -- | ---- |
| Foot Length | 0.18 |
| Foot Width | 0.18 |
| Static Instep Height | -0.16 |

: Pearson correlation coefficients between maximum instep height change and subjects’ anthropometric measurements {#tbl:corrs}


### Translating Instep and Arch Height to Footwear Design
A new measurement technique was proposed to analyze 4D foot scans for changes in instep height due to the dynamic nature of the MLA during gait. 
This method does not require the foot’s plantar surface to be captured, enabling collection of scans on a treadmill or across a walkway. 
The medial longitudinal arch is expected to drop in height during early to mid-stance, and then rise during late stance [@Hicks1954; @Ker1987; @Caravaggi2010; @Cashmere1999; @Leardini2007; @Stolwijk2014; @Welte2018; @Welte2021].
A similar pattern was seen in the instep height measurement. 
Across most subjects, the instep height measurement drops during early and mid-stance, and then rises during late-stance. Therefore, it can be hypothesized that the rise and fall of the MLA changes the instep height of the foot. 

Since the collected 4D scans do not include the plantar surface, the method used to measure instep height is slightly different than traditional static methods. 
The traditional method of measuring instep height is taken with respect to the ground when the foot is flat, which cannot be done with dynamic 4D scans captured on a non-transparent surface. 
This is due to the foot lifting off the ground after heel-off and therefore not having a reference for the measurement. 
The proposed method provides the instep height with respect to a virtual vector drawn from the middle of the metatarsal heads to the pternion. 
This measurement technique is still valid for quantifying instep height changes as the arch is located above this virtual vector, and provides a standardized measurement across all subjects’ dynamic scans. 
Therefore, the reported changes in instep height may still be accurate even when the full instep height measurement is not taken. 

Five of the thirty subjects did not have a strong correlation between their instep height and the MTP joint angle. 
No anomalies with the instep height measurement were identified after manually reviewing the subject’s 4D scans. 
In addition, manually reviewing the subject’s MTP and ankle joint kinematics also did not reveal any differences. 
These subjects’ static instep heights were also similar to subjects whose instep height had a strong correlation to the MTP joint angle. 
Since instep height was found to be highly correlated to arch height, these subjects’ arch height also cannot explain why they have low correlations to the MTP joint angle during stance phase. 
However, some of these subjects (Subjects 2, 21, and 29) still have a rise in instep height in late stance that is characteristic of the arch height rise due to the windlass and arch-spring mechanisms [@Hicks1954; @Ker1987]. 
The low correlation suggests that for these subjects, instep height changes may be occurring primarily due to the arch spring hypothesis rather than the windlass hypothesis [@Ker1987]. 
On the other hand, subjects 16 and 22 had little to no change in instep height. 
The five subjects in the group without a strong correlation between instep height and MTP joint angle may have a foot structure that responds differently compared to the other subjects’, or their arch may not be aligned with the location at which the instep height measurement was taken. 
While the data collected in this study was unable to isolate differences in these subjects, future work can explore if other factors may be contributing to the low correleation. 

Static arch height has been previously shown to have low correlation to foot length [@Hill2017]. 
In this study, no strong correlations were found between instep height changes and other foot anthropometric measurements, suggesting that the instep height change is another mode of variation in foot shape. 
In addition, there were some subjects in this study who did not have a strong correlation between arch height and MTP joint angle. 
Both findings suggest that arch and instep height varies inter-individually. 

This finding has many implications for footwear design. Geometric, proportional, and arithmetic last grading techniques vary the dimensions of the master last by a percentage of the last, by fixed proportions in various dimensions, or by a fixed increment in various dimensions, respectively. 
However, these grading techniques cannot consider the variability of static arch height and dynamic instep height, as this variability seems to be different for everyone. 
Therefore, adjustable mechanisms at the instep area to personalize fit may be necessary to allow footwear to fit a large population more effectively. 
In addition, these mechanisms should be adaptable to the dynamic changes in instep height during gait. 
A fixed instep area might result in heel-lift just before heel-off when the instep height has dropped and there is empty space in the shoe. 

The tongue and shoelaces can provide adjustment at the instep area independent of shoe size. 
Shoe lacing provides tension over the tongue of the shoe [@Hagen2009; @Polster2002], which ensures that the tongue stays snug on your instep area. 
Findings from this study show that the tongue should accommodate at least 20 mm of movement to fit most subject’s instep height changes.  
This will capture the foot in the shoe and therefore prevent heel-lift.
Individuals can adjust the lacing to best accommodate their static instep height. 
Shoe lace tension can also be adjusted by varying the number of eyelets and lacing pattern used by the individual [@Hagen2009; @Hagen2010].
Therefore, shoelace tension can be adjusted by an individual to match their dynamic instep height and arch function. 
An individual with large instep height changes during stance phase could have higher-tension lacing to ensure the tongue can rise in late stance and then collapse again during the following step’s mid-stance phase. 
Alternatively, an individual with low instep height changes may not need to tension their shoelaces as high. 
Therefore, shoelaces can allow individuals from this study with high correlation between their instep height and MTP joint angle, and those with low correlation between their instep height and MTP joint angle, to adjust shoe fit to their foot shape and dynamic nature. 
Advanced shoe lacing concepts have also been shown to reduce in-shoe motion, which could be due to their superior tension provided by these concepts [@Pryhoda2021; @Myers2019]. 
These concepts could also be providing an easier mechanism for the wearer to adjust the tension appropriately; these wearers could adjust the tension to their liking in an easier fashion to ensure that they are minimizing in-shoe motion while still maintaining comfort. 

It should also be noted that the dynamic instep height measurement may not be only due to the MLA. 
It has been suggested that the foot’s transverse arch can also change in curvature due to load, and also affect the foot’s stiffness [@Venkadesan2020]. 
As the transverse arch is also located close to the region of the foot where the instep height is measured, it may also have a dynamic component that is contributing to the rise of the instep during gait. 
Further studies of the transverse arch mechanics may be needed to confirm this. 

## Summary
A 4D scanning system was developed to capture dynamic foot shape changes, and was used to collect data for development of the model. 
To the authors' knowledge, this is the first parametric foot SSM that captures and reconstructs dynamic motion.
The model was able to identity specific changes in foot morphology as they related to subject and kinematic parameters, and suggest spacesuit boot design techniques to reduce instances of heel-lift.

The dynamic shape changes around the arch were further studied, as the arch is a challenging to fit properly. 
The instep height measurement was found to closely correlate to the arch height measurement.
A new method of measuring instep height on dynamic foot scans without a plantar surface was developed. 
Strong correlations were found between the MTP joint angle and the instep height, reinforcing the dynamic nature of the MLA angle dynamics. 
However, correlations were low between instep height change and static foot measurements, highlighting the need for adjustable and potentially dynamic lacing integrated into the upper to maintain fit throughout the gait cycle. 













